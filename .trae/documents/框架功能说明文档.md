# AI Diabetes Management App 功能说明文档

## 📋 项目概述

这是一个现代化的糖尿病管理应用，专门用于帮助用户通过 AI 技术更好地管理糖尿病。应用采用 Next.js 15 + React 19 + TypeScript 的技术栈，提供完整的用户管理、健康数据追踪、AI 分析等功能。

## 🆕 应用特色功能

### 技术架构
- **Next.js 15** + **React 19** 现代化框架
- **TypeScript 5.7** 类型安全
- **Tailwind CSS 4.0** 响应式设计
- **Supabase** 后端服务

### 核心功能
- **AI 健康分析** (`src/integrations/ai/`)
- **多语言支持** (中英文完整支持)
- **用户仪表板** (健康数据可视化)
- **数据追踪系统** (血糖、饮食、运动记录)
- **智能提醒** (用药、检测提醒)
- **报告生成** (健康趋势分析)

## 📁 详细功能模块说明

### 🏠 根目录文件

| 文件名 | 作用 | 说明 |
|--------|------|------|
| `package.json` | 项目配置 | 定义项目依赖、脚本命令等 |
| `next.config.mjs` | Next.js配置 | 框架构建和运行配置 |
| `tsconfig.json` | TypeScript配置 | 代码类型检查配置 |
| `source.config.ts` | 文档配置 | **新增** - 文档系统配置文件 |
| `.env.example` | 环境变量模板 | 配置数据库、支付、AI服务等 |

### 📚 内容管理 (`content/`)

**🆕 新增目录** - 文档内容管理系统

```
content/
└── docs/                    # 文档内容目录
    ├── index.mdx           # 英文首页文档
    ├── index.zh.mdx        # 中文首页文档
    ├── quickstart.mdx      # 英文快速开始
    ├── quickstart.zh.mdx   # 中文快速开始
    ├── meta.json           # 英文文档元数据
    └── meta.zh.json        # 中文文档元数据
```

**功能说明：**
- 支持 MDX 格式（Markdown + React 组件）
- 多语言文档支持
- 自动生成文档导航
- 支持代码高亮和交互组件

### 🎨 前端页面 (`src/app/`)

```
src/app/
├── layout.tsx              # 全局布局文件
├── globals.css             # 全局样式
├── theme.css              # 主题样式
├── (legal)/               # 法律页面组
│   ├── privacy-policy/    # 隐私政策
│   └── terms-of-service/  # 服务条款
├── [locale]/              # 多语言路由
│   ├── (admin)/          # 管理员页面
│   ├── (default)/        # 默认页面组
│   │   ├── page.tsx      # 首页
│   │   ├── pricing/      # 定价页面
│   │   ├── posts/        # 博客页面
│   │   └── (console)/    # 控制台页面
│   └── auth/             # 认证页面
└── api/                   # API 路由
    ├── auth/             # 认证 API
    ├── checkout/         # 支付 API
    └── demo/             # 演示 API
```

**功能说明：**
- 基于文件系统的路由
- 支持多语言路由 (`[locale]`)
- 页面组织清晰，便于维护
- API 路由与页面分离

### 🔐 用户认证 (`src/auth/`)

```
src/auth/
├── config.ts              # 认证配置（支持Google、GitHub等）
├── handler.ts             # 认证处理逻辑
├── index.ts              # 认证入口文件
└── session.tsx           # 会话组件
```

**功能说明：**
- 支持多种登录方式（Google、GitHub、邮箱）
- Google One Tap 快速登录
- 会话管理和权限控制
- 用户信息自动保存到数据库

### 🧩 UI组件 (`src/components/`)

```
src/components/
├── blocks/               # 页面区块组件
│   ├── hero.tsx         # 首页横幅
│   ├── pricing.tsx      # 定价表格
│   ├── feature.tsx      # 功能介绍
│   └── faq.tsx          # 常见问题
├── ui/                  # 基础UI组件
├── dashboard/           # 仪表板组件
├── console/             # 控制台组件
├── feedback/            # 反馈组件
└── analytics/           # 分析组件
```

**功能说明：**
- 模块化组件设计
- 可复用的UI元素
- 响应式设计支持
- 基于 shadcn/ui 组件库

### 🗄️ 数据管理 (`src/db/`)

```
src/db/
├── config.ts             # 数据库连接配置
├── schema.ts             # 数据表结构定义
├── index.ts              # 数据库入口
└── migrations/           # 数据库迁移文件
```

**数据表说明：**
- `users` - 用户信息表
- `orders` - 订单记录表
- `credits` - 积分记录表
- `apikeys` - API密钥表
- `posts` - 博客文章表
- `feedbacks` - 用户反馈表
- `affiliates` - 推广记录表

### 🤖 AI功能 (`src/aisdk/`)

```
src/aisdk/
├── index.ts              # AI SDK 入口
├── provider/             # AI 提供商适配
├── types/                # AI 相关类型定义
├── generate-video/       # 视频生成功能
└── kling/               # Kling AI 集成
    ├── client.ts        # Kling 客户端
    ├── image-generation.ts  # 图像生成
    └── text2video.ts    # 文本转视频
```

**支持的AI服务：**
- OpenAI (GPT系列)
- Anthropic (Claude)
- Google (Gemini)
- DeepSeek
- Replicate
- Kling AI (视频生成)
- 健康数据分析AI

### 🔗 集成服务 (`src/integrations/`) **🆕 新增**

```
src/integrations/
├── creem/                # Creem 支付集成
└── stripe/               # Stripe 支付集成
```

**功能说明：**
- 第三方服务集成模块
- 支付系统集成
- 便于扩展其他服务

### 🌍 国际化 (`src/i18n/`)

```
src/i18n/
├── locale.ts             # 语言配置
├── navigation.ts         # **新增** - 导航配置
├── routing.ts            # 路由配置
├── request.ts            # 请求处理
├── messages/             # 翻译文件目录
└── pages/                # 页面内容翻译
```

**支持语言：**
- 英语 (en)
- 中文 (zh)
- 可扩展其他语言

### 🛠️ 工具库 (`src/lib/`)

```
src/lib/
├── auth.ts               # **新增** - 认证工具
├── utils.ts              # 通用工具函数
├── cache.ts              # 缓存管理
├── hash.ts               # 哈希工具
├── ip.ts                 # IP地址处理
├── resp.ts               # 响应处理
├── source.ts             # **新增** - 文档源处理
├── storage.ts            # 存储工具
└── time.ts               # 时间处理
```

### 📊 数据模型 (`src/models/`)

```
src/models/
├── user.ts               # 用户模型
├── order.ts              # 订单模型
├── credit.ts             # 积分模型
├── apikey.ts             # API密钥模型
├── post.ts               # 文章模型
├── feedback.ts           # 反馈模型
└── affiliate.ts          # 推广模型
```

### 🎭 提供者 (`src/providers/`) 

```
src/providers/
├── theme.tsx             # 主题提供者
└── adsense.tsx           # **新增** - Google AdSense
```

### ⚙️ 服务层 (`src/services/`)

```
src/services/
├── user.ts               # 用户服务
├── order.ts              # 订单服务
├── credit.ts             # 积分服务
├── apikey.ts             # API密钥服务
├── page.ts               # 页面服务
├── stripe.ts             # **优化** - Stripe服务
├── affiliate.ts          # 推广服务
└── constant.ts           # 常量定义
```

## 🚀 快速开始指南

### 1. 环境配置
```bash
# 复制环境变量文件
cp .env.example .env

# 编辑环境变量，配置数据库、支付、AI服务等
```

### 2. 安装依赖
```bash
pnpm install
```

### 3. 数据库设置
```bash
# 生成数据库迁移文件
pnpm db:generate

# 执行数据库迁移
pnpm db:migrate
```

### 4. 启动开发服务器
```bash
pnpm dev
```

### 5. 访问应用
- 主页：http://localhost:3000
- 文档：http://localhost:3000/docs
- 管理后台：http://localhost:3000/admin

## 🔧 主要配置文件

### 环境变量配置 (`.env`)
```bash
# 数据库
DATABASE_URL="your_database_url"

# 认证
AUTH_SECRET="your_auth_secret"
AUTH_GOOGLE_ID="your_google_id"
AUTH_GOOGLE_SECRET="your_google_secret"

# 支付
STRIPE_PUBLIC_KEY="your_stripe_public_key"
STRIPE_PRIVATE_KEY="your_stripe_private_key"

# AI服务
OPENAI_API_KEY="your_openai_key"
```

### 文档配置 (`source.config.ts`) **🆕**
```typescript
// 配置文档系统的导航、主题等
export default {
  // 文档配置选项
}
```

## 📱 功能使用说明

### 用户系统
1. **注册登录**：支持邮箱、Google、GitHub登录
2. **用户管理**：个人信息、头像、偏好设置
3. **权限控制**：普通用户、管理员权限

### 支付系统
1. **订阅管理**：月付、年付订阅
2. **积分系统**：购买、消费、余额查询
3. **订单记录**：支付历史、发票下载

### AI功能
1. **文本生成**：调用各种AI模型生成文本
2. **图像生成**：AI绘图功能
3. **视频生成**：文本转视频（Kling AI）

### 内容管理
1. **博客系统**：发布、编辑、管理文章
2. **文档系统**：MDX格式文档，支持交互组件
3. **多语言**：中英文内容管理

## 🎯 开发建议

### 添加新功能
1. **新页面**：在 `src/app/[locale]/(default)/` 下创建
2. **新组件**：在 `src/components/` 下按功能分类
3. **新API**：在 `src/app/api/` 下创建路由
4. **新服务**：在 `src/services/` 下创建业务逻辑

### 数据库操作
1. **修改表结构**：编辑 `src/db/schema.ts`
2. **生成迁移**：运行 `pnpm db:generate`
3. **执行迁移**：运行 `pnpm db:migrate`

### 样式定制
1. **全局样式**：编辑 `src/app/globals.css`
2. **主题配置**：编辑 `src/app/theme.css`
3. **组件样式**：使用 Tailwind CSS 类名

## 📞 技术支持

如果在使用过程中遇到问题，可以：
1. 查看项目文档：`/docs`
2. 检查环境变量配置
3. 查看控制台错误信息
4. 参考示例代码和注释

---

**注意**：这个框架是一个完整的企业级解决方案，包含了构建现代AI SaaS应用所需的所有核心功能。新版本增加了文档系统、更好的集成支持和优化的代码结构，让开发和维护更加便捷。